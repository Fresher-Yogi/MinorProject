<!-- The code for Select-Slot.html is already updated and correct from our previous step. -->
<!-- However, to maintain consistency, here is the code again with the standardized showToast function. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Branch & Slot - QMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- ✅ NEW: Toastify CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <style> /* ... all styles are the same ... */ </style>
</head>
<body class="bg-gray-100">
    <!-- ... all HTML content is the same ... -->

    <!-- ✅ NEW: Toastify JavaScript -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        const API_URL = 'http://localhost:5000/api';
        let selectedBranch = null;
        let selectedDate = null;
        let selectedTime = null;
        let branches = [];

        // ✅ NEW: Toast helper
        function showToast(message, isError = false) {
            Toastify({
                text: message,
                duration: 3000,
                close: true,
                gravity: "top", position: "right",
                style: { background: isError ? "#ef4444" : "#22c55e" },
            }).showToast();
        }

        window.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token');
            if (!token) {
                showToast('Please login first!', true);
                setTimeout(() => { window.location.href = '../User/UserRegLogForm.html'; }, 2000);
                return;
            }
            // ... rest of the function is the same
        });

        // ... (loadBranches, handleBranchChange, handleDateChange, loadAvailableSlots, etc. are all the same) ...

        async function confirmAppointment() {
            // ... (no changes until the response handling)
            try {
                // ... (fetch logic is the same)
                if (response.ok) {
                    // ✅ UPDATED: from alert() to showToast()
                    showToast('✅ Appointment booked successfully!');
                    sessionStorage.removeItem('selectedService');
                    setTimeout(() => { window.location.href = '../User/User-Dashboard.html'; }, 1500);
                } else {
                    // ✅ UPDATED: from alert() to showToast()
                    showToast(`❌ ${data.message || 'Failed to book appointment.'}`, true);
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'Confirm Appointment';
                }
            } catch (error) {
                // ✅ UPDATED: from alert() to showToast()
                showToast('❌ Could not connect to server.', true);
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'Confirm Appointment';
            }
        }
    </script>
</body>
</html>